
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Molecular Simulation - AI4Science101</title>
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/favicon.png" 
    />
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Molecular Simulation | AI4Science101</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Molecular Simulation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="AI for Science 101" />
<meta property="og:description" content="AI for Science 101" />
<link rel="canonical" href="http://localhost:4000/blogs/molecular_simulation/" />
<meta property="og:url" content="http://localhost:4000/blogs/molecular_simulation/" />
<meta property="og:site_name" content="AI4Science101" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Molecular Simulation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"AI for Science 101","headline":"Molecular Simulation","url":"http://localhost:4000/blogs/molecular_simulation/"}</script>
<!-- End Jekyll SEO tag -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-183522810-1"></script>
<script>
  window['ga-disable-UA-183522810-1'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-183522810-1');
</script><!-- head scripts --></head>

  <body>
    
<nav class="navbar is-primary" >
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-brand" href="/">
            <span><img src="/logonav.png" alt="Logo" style="height: auto; width: auto; max-height: 45px; max-width: 250px;"></span>
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu">
            <div class="navbar-end">
                
                
                    
                    <a href="/" class="navbar-item ">Home</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a href="/blogs/" class="navbar-link ">Blogs</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/blogs/announcement/" class="navbar-item ">Announcement</a>
                            
                            <a href="/blogs/ai_for_science_science/" class="navbar-item ">AI for Scientific Discovery</a>
                            
                            <a href="/blogs/ai_for_science_ai/" class="navbar-item ">Scientific Discovery in the era of AI</a>
                            
                            <a href="/blogs/molecular_simulation/" class="navbar-item is-active">Molecular Simulation</a>
                            
                            <a href="/blogs/gaussian_processes/" class="navbar-item ">Gaussian Processes</a>
                            
                            <a href="/blogs/causal_machine_learning/" class="navbar-item ">Causal Machine Learning</a>
                            
                            <a href="/blogs/statistical_learning_theory/" class="navbar-item ">Statistical Learning Theory</a>
                            
                            <a href="/blogs/optimization/" class="navbar-item ">Optimization</a>
                            
                            <a href="/blogs/graph_machine_learning/" class="navbar-item ">Graph Machine Learning</a>
                            
                            <a href="/blogs/reinforcement_learning/" class="navbar-item ">Reinforcement Learning</a>
                            
                            <a href="/blogs/quantum_science/" class="navbar-item ">Quantum Science</a>
                            
                            <a href="/blogs/comp_sustainability/" class="navbar-item ">Computational Sustainability</a>
                            
                            <a href="/blogs/knowledge_base/" class="navbar-item ">Knowledge Base</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/resources/" class="navbar-item ">Resources</a>
                    
                
                
            </div>

        </div>
    </div>
</nav>

    
    


    <section class="section">
        <div class="container">
            <div class="columns">
                
                <div class="column is-4-desktop is-4-tablet">
                    

<aside class="menu">

</aside>
                </div>
                
                <div class="column is-8">
                    
                    
                    
                    
    
    

<div class="contents">
    <div class="menu">
        <p class="menu-label">Molecular Simulation</p>
        <ul class="menu-list">
  <li><a href="#before-you-start">Before you start</a></li>
  <li><a href="#what-is-molecular-dynamics">What is Molecular Dynamics?</a>
    <ul>
      <li><a href="#experiments-on-a-computer">Experiments on a computer</a></li>
      <li><a href="#why-do-we-run-md">Why do we run MD?</a></li>
      <li><a href="#the-inputs-and-outputs-of-md">The inputs and outputs of MD</a></li>
    </ul>
  </li>
  <li><a href="#starting-with-a-simple-example">Starting with a simple example</a>
    <ul>
      <li><a href="#basic-knowledge">Basic knowledge</a></li>
      <li><a href="#the-construction-of-theoretical-models---generating-force-fields">The construction of theoretical models - generating force fields</a></li>
      <li><a href="#preparation-for-simulation">Preparation for simulation</a></li>
      <li><a href="#simulation">Simulation</a></li>
      <li><a href="#results">Results</a></li>
    </ul>
  </li>
  <li><a href="#an-advanced-example">An advanced example</a>
    <ul>
      <li><a href="#building-model">Building Model</a></li>
      <li><a href="#solvent">Solvent</a></li>
    </ul>
  </li>
  <li><a href="#rare-events-and-enhanced-sampling">Rare Events and Enhanced Sampling</a></li>
  <li><a href="#ai-in-md">AI in MD</a></li>
  <li><a href="#references">References</a></li>
</ul>
    </div>
</div>




<div class="content">
    <script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<p>Author(s): Yanze Wang is a Ph.D. student @ MIT Chem and Broad Institute. He joined MIT and Broad Institute in 2022. He is a developer @Deepmodeling community. He is interested in molecular simulation and how computational tools help optimize bio-macromolecules with a special interest in RNA simulation.</p>

<h2 id="before-you-start">Before you start</h2>
<ul>
  <li>This tutorial assumes that you have already learned:
    <ul>
      <li>
        <p>Basic physics and chemistry knowledge</p>
      </li>
      <li>
        <p>Calculus</p>
      </li>
    </ul>
  </li>
  <li>If you want to deeply understand the principles and roles of molecular dynamics, you need to master the following:
    <ul>
      <li>
        <p>Mechanics, theoretical mechanics (analytical mechanics)</p>
      </li>
      <li>
        <p>Statistical Mechanics</p>
      </li>
      <li>
        <p>Physical Chemistry</p>
      </li>
      <li>
        <p>Numerical Methods / Computational Physics / Computational
  Methods</p>
      </li>
      <li>
        <p>Further topics:</p>
        <ul>
          <li>Quantum Chemistry</li>
          <li>Biochemistry or Solid State Physics, depending on the
  specific application</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="what-is-molecular-dynamics">What is Molecular Dynamics?</h2>

<p>Molecular Dynamics (MD) studies how atomic coordinates evolve under given conditions. It relies on the framework of <strong>classical mechanics</strong>(also known as <strong>Newtonian mechanics</strong>) and simulates the motion of molecular systems numerically. For instance, you can imagine the motion of two rigid balls connected by a spring.</p>

<h3 id="experiments-on-a-computer">Experiments on a computer</h3>

<p>MD is a computational method, a chemical experiment performed on computers. Let’s imagine a chemical experiment in the real world first. One may have to prepare experimental instruments and drugs, set instrument parameters, conduct experiments, wait for chemical reactions to proceed, obtain experimental results, and then analyze experimental results. MD is quite similar; we use a table to compare MD with the traditional chemical experiments:</p>

<table>
  <thead>
    <tr>
      <th>Chemical experiment</th>
      <th>Molecular dynamics simulation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Prepare experimental instruments</td>
      <td>Prepare computing hardware (CPU, GPU, etc.)<br />Prepare calculation software (Gromacs, Lammps, etc.)</td>
    </tr>
    <tr>
      <td>Prepare experimental drugs</td>
      <td>Prepare a file describing the molecular structure as an initial conformation for the simulation process</td>
    </tr>
    <tr>
      <td>Set instrument parameters</td>
      <td>Set simulation parameters (simulation temperature, simulation time, etc.)<br />Set force field parameters (parameters that can be analogous to spring coefficients)</td>
    </tr>
    <tr>
      <td>Conduct chemical experiments</td>
      <td>Run MD simulations</td>
    </tr>
    <tr>
      <td>Get experimental results</td>
      <td>Get the simulated trajectory</td>
    </tr>
    <tr>
      <td>Analyze experimental results</td>
      <td>Analysis of physico-chemical properties from trajectories obtained from simulations (calculation of statistics)</td>
    </tr>
  </tbody>
</table>

<center> <span id="tab:addlabel" label="tab:addlabel">Table 1: Molecular Dynamics Procedure</span> </center>
<p><br /></p>

<h3 id="why-do-we-run-md">Why do we run MD?</h3>

<p>Molecular dynamics simulations can allow us to simulate chemical and physical processes on computers, obtain kinetic information at the microscopic scale, provide theoretical support for experiments and guide chemical experiments. Moreover, computational simulations can help reduce the cost of manually conducting experiments. MD can also be performed under special (usually severe) conditions (ultra-high pressure, ultra-high temperature, strong electric field, magnetic field, etc.)</p>

<p>However, its basis in classical mechanics means that MD can only be effective for physical processes at the molecular scale (e.g. $nm$). For simulations involving electronic structures MD doesn’t work.</p>

<ul>
  <li>
    <p>Systems that can be simulated with classical molecular dynamics:</p>

    <ul>
      <li>
        <p>Protein systems (protein folding problems, etc.)</p>
      </li>
      <li>
        <p>RNA systems</p>
      </li>
      <li>
        <p>Atomic-scale material systems</p>
      </li>
      <li>
        <p>Free energy calculation</p>
      </li>
      <li>
        <p>Catalytic reactions that do not involve electron transfer</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Problems that classical MD <em>can not</em> solve (or cannot be solved only by classical MD):</p>

    <ul>
      <li>
        <p>Magnetic and electrical properties of materials (requires quantum chemistry tools)</p>
      </li>
      <li>
        <p>Calculate the energy of molecular conformation (requires quantum chemistry method, current software include Gaussian, Vasp)</p>
      </li>
      <li>
        <p>Protease-catalyzed reactions involving electron transfer (requires QM/MM method)</p>
      </li>
      <li>
        <p>Chemical reactions involving electron transfer (requires QM/MM method)</p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="the-inputs-and-outputs-of-md">The inputs and outputs of MD</h3>

<p>Inputs to molecular dynamics simulations are an initial conformation of molecules. They should contain the coordinates of the atoms, the information of chemical bonds among atoms (also called topology information), etc.</p>

<p>The outputs of molecular dynamics are molecular trajectories (trajectory refers to a continuous molecular motion in the coordinate space or Cartesian space) simulated from the initial conformations.</p>

<h2 id="starting-with-a-simple-example">Starting with a simple example</h2>

<p>Here we consider a simple example of a molecular dynamics simulation for a hydrogen molecule in vacuum. \(H - H\) (a single hydrogen molecule)</p>

<h3 id="basic-knowledge">Basic knowledge</h3>

<p>Let’s go over some basic knowledge before simulations:</p>

<ul>
  <li>Molecules have an associated energy, which can be divided to potential energy (denoted by V) and kinetic energy (denoted by T). Potential energy is related to the coordinates of the atoms in molecules, while kinetic energy is related to the velocity (or momentum) of the atoms.</li>
</ul>

\[E = T + V\]

\[E = \frac{1}{2} m v^2+V(\vec{q}) \text{ or } E = \frac{p^2}{2m} + V(\vec{q})\]

<p>where \(q\) represents the vector coordinates of atoms and \(p\) represents the momentum of atoms.</p>

<ul>
  <li>Force is the negative derivative of the energy over coordinates. Since kinetic energy has nothing to do with positions (coordinates), force is also equal to the negative derivative of potential energy over coordinates.</li>
</ul>

\[F_i = -\frac{\partial E}{\partial q_i} = - \frac{\partial V}{\partial q_i}\]

<h3 id="the-construction-of-theoretical-models---generating-force-fields">The construction of theoretical models - generating force fields</h3>

<h4 id="why-do-we-need-force-fields"><strong>Why do we need force fields?</strong></h4>

<p>To simulate the motion of hydrogen molecules, we need to know the forces exerted on hydrogen atoms at different positions. These can be used to calculate changes of velocity and coordinates. This is equivalent to knowing the potential energy surface of the H<sub>2</sub> molecule.</p>

<p>How do we get the potential energy surface? The most straightforward way is to calculate the energy by solving Schrödinger equations, and then calculate forces from derivatives. Then our simulation process becomes:</p>

<center> <img src="/img/Molecular_Dynamics/md_ff.jpeg" pic_center="" width="90%" height="90%" />  </center>

<p>Every time we get a new position in the coordinate space, we need to solve a new set of Schrödinger equations. It is very time-consuming and laborious for complex systems. However, to calculate the motion of hydrogen atoms, we don’t need to know the exact information of the electrons in hydrogen atom, but only the position information of the nucleus. Thus we need <strong>the Born-Oppenheimer approximation</strong>.</p>

<p><strong>The Born-Oppenheimer approximation</strong> is a quantum chemical approximation for electrons. Since nuclei are much heavier than electrons, they move much slower. We can assume that the motion of the nuclei is only affected by the mean-field of electrons.</p>

<p>Simply speaking, we only need to know the positions and forces about the hydrogen nucleus. The influence of electrons can be represented by some force field parameters under approximations. For example, we can approximate the hydrogen molecule as a spring model, and regard the interaction from electrons (or chemical bonds) as a spring. The force generated by the chemical bond is described by the spring coefficient. In this way, we transform the problem of solving Schrödinger equations to calculating the force of a spring:</p>

\[F = k(x-x_0)\]

<p>where k represents the spring coefficient, and x<sub>0</sub> represents the offset from the equilibrium position. As a result, calculations are greatly simplified. Here, the <strong>k (spring coefficient, or force constant)</strong> and <strong>x0 (equilibrium positions)</strong> are simplified <strong>force field parameters</strong>, also known as the <strong>force field</strong>.</p>

<p>Note that such simplification can significantly reduce the accuracy of MD simulations, so MD can only reflect the information near equilibrium states. But for macro statistics (e.g. chemical shift, protein contact), it is usually a sufficient description.</p>

<h4 id="the-actual-force-field-parameters"><strong>The actual force field parameters.</strong></h4>

<p>In real MD simulations, almost all inter-atomic and inter-molecular forces are approximated by an analytical expression of classical mechanics. These <strong>empirical parameters are obtained by fitting experimental data or data from quantum calculations}(for example, gradient descent optimization</strong>. Usually, the format of force fields looks like a combination of terms like:</p>

\[U =\sum_{\text {bonds }} \frac{1}{2} k_{b}\left(r-r_{0}\right)^{2}+\sum_{\text {angles }} \frac{1}{2} k_{a}\left(\theta-\theta_{0}\right)^{2}+\sum_{\text {torsions }} \frac{V_{n}}{2}[1+\cos (n \phi-\delta)] +\]

\[\sum_{\text {improper }} V_{i m p}+\sum_{\mathrm{LJ}} 4 \epsilon_{i j}\left(\frac{\sigma_{i j}^{12}}{r_{i j}^{12}}-\frac{\sigma_{i j}^{6}}{r_{i j}^{6}}\right)+\sum_{\text {elec }} \frac{q_{i} q_{j}}{r_{i j}}\]

<p>These interactions include:</p>

<ul>
  <li>
    <p>Short-range interactions:</p>

    <ul>
      <li>
        <p>bonds</p>
      </li>
      <li>
        <p>angles</p>
      </li>
      <li>
        <p>torsion (dihedral angles)</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Long-range interactions</p>

    <ul>
      <li>
        <p>Electrostatic interactions (Coulomb interactions, elec)</p>
      </li>
      <li>
        <p>Van der Waals</p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="preparation-for-simulation">Preparation for simulation</h3>

<p>Now, we have modeled a hydrogen molecule. For simplicity, let the force constant of the hydrogen molecule be \(0.1 kJ/\mathring A^2\). Then let the equilibrium bond length be \(0.5\mathring A\), and the mass of the hydrogen atom is assumed to be (1) (just for demonstration).</p>

<ul>
  <li>To start the simulation, we also need the initial conditions (initial conformation and initial velocity). Also for simplicity, we assume that the coordinates of the two atoms are [0.7, 0, 0], [0, 0, 0] (Unit: angstrom), and the velocities are [-0.1, 0, 0], [0.1, 0 , 0] (Unit: angstrom/fs)</li>
</ul>

<center> <img src="/img/Molecular_Dynamics/example1.jpeg" pic_center="" width="90%" height="90%" />  </center>

<ul>
  <li>
    <p>Next, let’s set the simulation parameters: since we calculate the differential equation numerically, we need to give the minimum simulation time interval, which is generally set to be 2 fs.(which is actually the grid size for time dimension in finite difference method).</p>
  </li>
  <li>
    <p>Set the simulation to 5 steps, so the total simulation time is 10 fs.</p>
  </li>
  <li>
    <p>Set the simulated temperature to 300K (this affects the velocity initialization and force field parameters, which should be set before velocity initialization).</p>
  </li>
</ul>

<p>Ready? Let’s simulate!</p>

<h3 id="simulation">Simulation</h3>

<p>(Please be aware that units are omitted for simplicity)</p>

<ol>
  <li>Calculate the force on the hydrogen atoms from the initial positions:</li>
</ol>

\[F_x=k(x-x_0)=0.1\times(1-0.5)=0.05\]

<ol>
  <li>Calculate the accelerations:</li>
</ol>

\[a_x = \frac{F}{m}=0.05\]

<ol>
  <li>Update velocities:</li>
</ol>

\[\Delta v_x=a\times \Delta t=0.05 * 2=0.1\]

\[\Delta x = v_x \times \Delta t=0.1 * 2=0.2\]

<ol>
  <li>
    <p>Update the coordinates and velocities through the calculation above to obtain new coordinates:</p>
  </li>
  <li>
    <p>(Repeat) Calculate the new force</p>
  </li>
  <li>
    <p>(Repeat) Calculate the new acceleration</p>
  </li>
</ol>

<center> <img src="/img/Molecular_Dynamics/example2.jpeg" pic_center="" width="90%" height="90%" />  </center>

<h3 id="results">Results</h3>

<p>Finally, we will obtain positions of H atoms at different times, and these “continuous” motions compose the MD trajectory.</p>

<p>Through long-term MD simulations, we can calculate <strong>physical and chemical</strong> properties from the trajectories. (such as RMSD changes, conformation transitions, ensemble averaging of physical quantities, etc.)</p>

<p><strong>Notes</strong>: Here, the equations from Newtonian mechanics are used for the purposes of demonstration. MD simulation is <strong>usually more complicated</strong>. Depending on the required <strong>ensemble</strong>, numerical evolution of partial differential equations will be carried out under specific Hamiltonian mechanics.</p>

<p>We will not introduce the concept of the ensemble in detail here. If you are interested in it, please read the related content about <strong>statistical mechanics</strong>.</p>

<h2 id="an-advanced-example">An advanced example</h2>

<p>In this part, we will use an example of a <strong>protein</strong> to illustrate how to conduct MD simulations in real-world research.</p>

<h3 id="building-model">Building Model</h3>

<p>Again, we use the BO approximation to construct models for proteins. These models include information on bond types, atom types, and force field parameters for various interactions. We usually need the following files:</p>

<ul>
  <li>
    <p>topology (<code class="language-plaintext highlighter-rouge">topol.top</code> for example): Contains molecular bonding information, molecular type information, and atomic type information</p>
  </li>
  <li>
    <p>force field (<code class="language-plaintext highlighter-rouge">forcefield.itp</code> for example): contains chemical bond equilibrium positions, chemical bond force constants, non-bond force constants, etc.</p>
  </li>
  <li>
    <p>Commonly used force fields are as follows:</p>

    <ul>
      <li>
        <p>Amber</p>
      </li>
      <li>
        <p>Charmm</p>
      </li>
      <li>
        <p>Gromos</p>
      </li>
      <li>
        <p>OPLS</p>
      </li>
    </ul>
  </li>
  <li>
    <p>So far there is no unified database or maintenance of methods for force fields, and each force field is maintained by each company or organization. Developing a force field is a difficult and nuanced process.</p>
  </li>
</ul>

<h3 id="solvent">Solvent</h3>

<p>Unlike systems in vacuum, proteins generally exist in solvents. We therefore need to account for and model the solvent. We can do this in two ways:</p>

<ul>
  <li>
    <p><strong>Explicit solvent model.</strong>  It is often used in all-atom simulations, that is, directly introducing solvent molecules into the system. The force field parameters for solvent molecules are usually included in the force field file. Commonly used models for water are SCP, TIP3P, TIP4P, etc.</p>

    <ul>
      <li>
        <p>Advantages: Similar to the actual physical process, the results are more accurate. It can describe solvent-involved processes (e.g. protein-ligand binding). It can also explicitly describe solvent effects such as hydrogen bonding.</p>
      </li>
      <li>
        <p>Disadvantages: high computational complexity. A system usually contains hundreds or thousands of solvent molecules.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Implicit solvent model.</strong> The effect of the solvent on the solute is described by a continuous electric field model. The Generalized Born model is an example of commonly used model.</p>

    <ul>
      <li>
        <p>Advantages: low computational complexity, no need to introduce additional solvent molecules.</p>
      </li>
      <li>
        <p>Disadvantages: Imprecise, solvent-involved reactions cannot be described.</p>
      </li>
    </ul>
  </li>
</ul>

<!-- end list -->

<ol>
  <li>
    <p><strong>Periodic Boundary Conditions</strong>:</p>

    <p>Due to limited computation resources it is impossible for us to simulate an infinitely large system, nor to simulate infinite steps. For a protein system, tens of thousands of atoms already require a lot of calculations (the required calculation time is measured in days), but this is still far less than Avogadro’s constant(10<sup>23</sup>).</p>

    <p>However, simulating a small system will be seriously affected by the interface and cannot reflect the properties of the bulk phase.</p>

    <p>To solve this problem, we often use <strong>periodic boundary conditions</strong>. We confine the system of interest in a box and assume the properties of the actual system can be approximated by an virtual infinite system of repeating side-by-side lattices. If the molecule passes through the box boundary, it will re-enter the box from the opposite boundary, forming a periodic space.</p>
  </li>
</ol>

<center> <img src="/img/Molecular_Dynamics/periodic_system.jpeg" pic_center="" width="30%" height="30%" />  </center>

<center>Figure 1: Periodic system</center>

<ol>
  <li>
    <p><strong>Preparation for simulation</strong></p>

    <p>Next, you need to prepare the conformation files of the protein and water molecules. Typically, protein structure files are generated by PDBs, then converted into a format that can be read by molecular dynamics software.</p>

    <p>We also need to prepare simulation parameter files, in which you need to set:</p>

    <ul>
      <li>
        <p>temperature</p>
      </li>
      <li>
        <p>time interval and duration for simulations</p>
      </li>
      <li>
        <p>the integrator/numerical algorithm, the ensemble for simulations</p>
      </li>
      <li>
        <p>the temperature/pressure controller</p>
      </li>
      <li>
        <p>the output-frequency and content of output files</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Simulation</strong> Commonly used MD simulation software in current research are as follows:</p>

    <ul>
      <li>
        <p>Amber [1]</p>

        <ul>
          <li>Commercial software. There is a free version and a high-performance optimized commercial version. The code is closed source and highly engineered. It supports most MD functions and plays an important role in the simulation of protein systems. Amber is often used in simulations of biological systems.</li>
        </ul>
      </li>
      <li>
        <p>Gromacs [2]</p>

        <ul>
          <li>Open-source MD simulation software. The latest release is the Gromacs 2022 release version. With efficient GPU optimization, there is a good developer community for Gromacs. This is mostly used for biological system simulation.</li>
        </ul>
      </li>
      <li>
        <p>OpenMM [3]</p>

        <ul>
          <li>Molecular dynamics simulation software with Python interfaces. Modules are implemented by calling functions from the Python command line, which can directly involve deep learning frameworks such as PyTorch. However, its compatibility has not been fully developed. Mostly used for biological system simulation.</li>
        </ul>
      </li>
      <li>
        <p>Lammps [4]</p>

        <ul>
          <li>MD software for material simulations.</li>
        </ul>
      </li>
    </ul>

    <p>Most MD software is fully optimized on GPU devices, which can provide greater efficiency than CPU devices. Another program, Charmm, can be used for preparing structures for MD but it can not be used for simulations.</p>

    <p>In addition, most software is compatible with other formats of force fields; for instance, Gromacs is compatible with Amber or Charmm force fields.</p>
  </li>
</ol>

<h2 id="rare-events-and-enhanced-sampling">Rare Events and Enhanced Sampling</h2>

<ul>
  <li>
    <p>Molecular dynamics algorithms have time reversibility and ergodic hypotheses. We assume that all states of a molecule have a probability to be explored (or traversed/sampled) after a sufficiently long simulation. These states include ground states, meta-stable states, and some high-energy states (unstable states). When the simulation reaches equilibrium, the distribution of molecular conformations in the system satisfies <strong>the Boltzmann distribution</strong> under its <strong>ensemble</strong>.</p>
  </li>
  <li>
    <p>Different states have different probabilities to be sampled. In most cases, the molecules are stuck in a local minimum on the energy surface, and it is difficult to jump over the energy barriers. Therefore, under finite-time simulations, the probability of sampling some high-energy state or another meta-state separated by an energy barrier is very low. These are <strong>rare events</strong>.</p>

    <ul>
      <li>Here, it can be compared with Monte Carlo (MC) simulations of a high-dimensional function, starting from a random value of the high-dimensional function to explore the global minima of the function. This can take a lot of time and computational resources.</li>
    </ul>
  </li>
  <li>
    <p>To increase the probability of rare events occurring in MD simulations, the simulation process can be interfered with using various methods:</p>

    <ul>
      <li>
        <p>Enhanced sampling based on temperature:</p>

        <ul>
          <li>
            <p>Raise the temperature, lower the energy barriers, and increase the probability of rare events.</p>
          </li>
          <li>
            <p>Replica-Exchange Molecular Dynamics (REMD)[5], selective integrated tempering sampling (SITS)[6], etc.</p>
          </li>
        </ul>
      </li>
      <li>
        <p>Enhanced sampling based on bias potential:</p>

        <ul>
          <li>
            <p>Collective variables (CV), are functions of system coordinates. The free energy are defined on collective variables. (Please refer to the difference between free energy and potential energy)</p>
          </li>
          <li>
            <p>Add bias potential to the given CVs during the simulations, which can push the trajectory out of the local minima on the energy surface to explore other states.</p>
          </li>
          <li>
            <p>Metadynamics[7], VES[8], RiD[9], etc.</p>
          </li>
          <li>
            <p>Traditional boosted sampling methods based on bias potential suffer from <strong>the curse of dimensionality.</strong></p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="ai-in-md">AI in MD</h2>

<p>The current difficulties restricting MD simulation are as follows:</p>

<ul>
  <li>
    <p>Simulation accuracy</p>

    <ul>
      <li>Introduced by the classical force field approximations to quantum mechanics.</li>
    </ul>
  </li>
  <li>
    <p>Sampling efficiency</p>

    <ul>
      <li>This is the most essential problem of MD. It is partly solved by enhanced sampling techniques but traditional enhanced sampling methods cannot solve high-dimensional problems. Excessive heating or aggressively increasing bias potential can lead to denaturation of systems.</li>
    </ul>
  </li>
</ul>

<p>Here, some people draw inspiration and seek solutions from deep learning to try solve these problems.</p>

<ul>
  <li>
    <p>DeePMD[10]</p>

    <ul>
      <li>By fitting quantum chemical data with neural networks, a potential energy surface with quantitative accuracy is obtained. The computational complexity of neural networks is far less than solving Schrödinger equations, so DeepMD can achieve molecular dynamics simulations with high-precision.</li>
    </ul>
  </li>
  <li>
    <p>Neural-networks-based enhanced sampling</p>

    <ul>
      <li>These methods obtain the representation of the high-dimensional free energy surface by fitting the mean-force data using neural networks. The bias potential is applied to the system to boost simulations, where neural networks alleviate the high-dimensional problem of multiple CVs. These works include NN-VES, Reinforced Dynamics, etc.</li>
    </ul>
  </li>
  <li>
    <p>CV Discovering</p>

    <ul>
      <li>Reduce the dimensionalities of the data through machine learning methods (SVM, VAE, GAN, etc.) to find the most essential collective variables. TorchCV[11] is a good example for this.</li>
    </ul>
  </li>
</ul>

<p><strong>Difficulties:</strong></p>

<ul>
  <li>
    <p>How to generate MD data for training ML models?</p>

    <ul>
      <li>Possible solutions: active learning, concurrent learning</li>
    </ul>
  </li>
  <li>
    <p>It is temporarily hard to do end-to-end simulation with similar efficiency to well-developed MD software.</p>
  </li>
</ul>

<h2 id="references">References</h2>

<p>[1] Romelia salomon ferrer, David Case, and Ross Walker. An overview of the amber biomolecular simulation package. Wiley Interdisciplinary Reviews: Computational Molecular Science, 3, 03 2013.</p>

<p>[2] Henk Bekker, Herman Berendsen, E.J. Dijkstra, S. Achterop, Rudi Drunen, David van der Spoel, A. Sijbers, H. Keegstra, B. Reitsma, and M.K.R. Renardus. Gromacs: A parallel computer for molecular dynamics simulations. Physics Computing, 92:252–256, 01 1993.</p>

<p>[3] Peter Eastman, Jason Swails, John Chodera, Robert Mcgibbon, Yutong Zhao, Kyle Beauchamp, Lee-Ping Wang, Andrew Simmonett, Matthew Harrigan, Chaya Stern, Rafal Wiewiora, Bernard Brooks, and Vijay Pande. Openmm 7: Rapid development of high performance algorithms for molecular dynamics. PLoS Comput Biol, 06 2017.</p>

<p>[4] Aidan Thompson, H. Metin Aktulga, Richard Berger, Dan Bolintineanu, W. Brown, Paul Crozier, Pieter in ’t Veld, Axel Kohlmeyer, Stan Moore, Trung Nguyen, Ray Shan, Mark Stevens, J. Tranchida, Christian Trott, and Steven Plimpton. Lammps - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales. Computer Physics communications, 271:108171, 09 2021.</p>

<p>[5] Zhou Ruhong. Replica exchange molecular dynamics method for protein folding simulation. Methods in molecular biology (Clifton, N.J.), 350:205–23, 02 2007.</p>

<p>[6] Lijiang Yang and Yi Gao. A selective integrated tempering method. The Journal of chemical physics, 131:214109, 12 2009.</p>

<p>[7] Alessandro Barducci and Massimiliano Bonomi. Metadynamics. WIREs Comput. Mol. Sci., 1:826, 09 2011.</p>

<p>[8] Luigi Bonati, Yue-Yu Zhang, and Michele Parrinello. Neural networks-based variationally enhanced sampling. Proceedings of the National Academy of Sciences, 116:201907975, 08 2019.</p>

<p>[9] Dongdong Wang, Yanze Wang, Junhan Chang, Linfeng Zhang, Han Wang, et al. Efficient sampling of high-dimensional free energy landscapes using adaptive reinforced dynamics. Nature Computational Science, 2(1):20–29, 2022.</p>

<p>[10] Linfeng Zhang, Jiequn Han, Han Wang, Roberto Car, and Weinan E. Deep potential molecular dynamics: a scalable model with the accuracy of quantum mechanics. July 2017.</p>

<p>[11] Luigi Bonati, Valerio Rizzi, and Michele Parrinello. Data-driven collective variables for enhanced sampling. The Journal of Physical Chemistry Letters, 11:2998–3004, 04 2020.</p>

</div>
                </div>
                
            </div>
        </div>
    </section>
    
        <!-- <footer class="footer">
    <div class="container">
        
        <div class="columns is-mobile">
            <div class="column is-8 has-text-left is-vcentered">
                <a class="navbar-brand" href="/">
                    <span><img src="/tdc_horizontal.png" alt="Logo" style="max-height: 40px; max-width: 250px;"></span>
                </a>
            </div>
            <div class="column is-4 has-text-right is-vcentered">
                <a href="https://arxiv.org/abs/2102.09548">
                    <span class="icon is-large">
                      <i class="fas fa-file-alt fa-3x"></i>
                    </span>
                </a>

                <a href="https://github.com/mims-harvard/TDC">
                    <span class="icon is-large">
                      <i class="fas fab fa-github fa-3x"></i>
                    </span>
                </a>

                <a href="https://twitter.com/ProjectTDC">
                    <span class="icon is-large">
                      <i class="fas fab fa-twitter fa-3x"></i>
                    </span>
                </a>

                <a href="https://join.slack.com/t/pytdc/shared_invite/zt-x0ujg5v6-zwtQZt83fhRdgrYjXRFz5g">
                    <span class="icon is-large">
                      <i class="fas fab fa-slack fa-3x"></i>
                    </span>
                </a>
            </div>
        </div>
        
    </div>
</footer> -->
    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>
</html>

